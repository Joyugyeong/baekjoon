-- 코드를 입력하세요
SELECT MONTH(START_DATE) AS MONTH, CAR_ID, COUNT(HISTORY_ID) AS RECORDS
FROM (
    SELECT *, COUNT(HISTORY_ID) OVER (PARTITION BY CAR_ID) AS CNT
    FROM CAR_RENTAL_COMPANY_RENTAL_HISTORY
    WHERE START_DATE >='2022-08-01' AND START_DATE <'2022-11-01'
    )AS SUB
WHERE CNT >=5
GROUP BY MONTH, CAR_ID
ORDER BY 1,2 DESC